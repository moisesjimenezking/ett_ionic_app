"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7191],{7191:(O,p,r)=>{r.r(p),r.d(p,{ChatsPageModule:()=>U});var l=r(177),m=r(4341),f=r(1626),c=r(8974),u=r(7112),g=r(3833),h=r(9866),t=r(6276),C=r(7157),x=r(6038);let v=(()=>{var e;class o{constructor(){}ngOnInit(){}}return(e=o).\u0275fac=function(s){return new(s||e)},e.\u0275cmp=t.VBU({type:e,selectors:[["app-chat-empty-state"]],decls:5,vars:0,consts:[[1,"w-full","h-full","flex","flex-col","justify-center","items-center","gap-3","px-2","py-3","text-primary-foreground"],[1,"material-icons","text-[90px]","fill-none"],[1,"text-2xl","text-primary-foreground","font-medium"]],template:function(s,a){1&s&&(t.j41(0,"div",0)(1,"span",1),t.EFF(2," chat "),t.k0s(),t.j41(3,"p",2),t.EFF(4," Todav\xeda no hay mensajes "),t.k0s()())}}),o})();var _=r(8945),b=r(2217);function y(e,o){if(1&e){const n=t.RV6();t.qex(0),t.j41(1,"div",4),t.bIt("click",function(){const i=t.eBV(n).$implicit,d=t.XpG(2);return t.Njj(d.onMessageSelected.emit(i))}),t.nrm(2,"ng-image",5),t.j41(3,"div",6)(4,"p",7),t.EFF(5),t.k0s(),t.j41(6,"div",8)(7,"p",9),t.EFF(8),t.k0s(),t.j41(9,"p",10),t.EFF(10),t.k0s()()()(),t.bVm()}if(2&e){const n=o.$implicit,s=t.XpG(2);t.R7$(2),t.Y8G("src",s.icSupportAsset),t.R7$(3),t.JRh(n.sourceName),t.R7$(3),t.SpI(" ",n.lastMsg," "),t.R7$(2),t.SpI(" ",n.lastMsgTime," ")}}function M(e,o){if(1&e&&(t.qex(0),t.j41(1,"ion-list",2),t.DNE(2,y,11,4,"ng-container",3),t.k0s(),t.bVm()),2&e){const n=t.XpG();t.R7$(2),t.Y8G("ngForOf",n.messages)}}function L(e,o){1&e&&(t.j41(0,"div",14),t.nrm(1,"div",15),t.j41(2,"div",16),t.nrm(3,"div",17),t.j41(4,"div",18),t.nrm(5,"div",19)(6,"div",20),t.k0s()()())}const I=function(){return[1,2,4,5]};function P(e,o){1&e&&(t.qex(0),t.DNE(1,L,7,0,"div",13),t.bVm()),2&e&&(t.R7$(1),t.Y8G("ngForOf",t.lJ4(1,I)))}function S(e,o){if(1&e&&(t.j41(0,"ion-list",11),t.DNE(1,P,2,2,"ng-container",12),t.k0s()),2&e){const n=t.XpG();t.R7$(1),t.Y8G("ngIf",n.isLoading)}}let j=(()=>{var e;class o{constructor(){this.messages=[],this.isLoading=!1,this.onMessageSelected=new t.bkB,this.icSupportAsset=_._U,this.utils=new h.b}ngOnInit(){}stablishUrlPic(s){return this.utils.stablishUrlPic(s)}}return(e=o).\u0275fac=function(s){return new(s||e)},e.\u0275cmp=t.VBU({type:e,selectors:[["app-chat-messages"]],inputs:{messages:"messages",isLoading:"isLoading"},outputs:{onMessageSelected:"onMessageSelected"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["LoadingState",""],[1,"bg-muted","rounded-lg","divide-y-[.25px]","divide-destructive-foreground","px-5"],[4,"ngFor","ngForOf"],[1,"flex","items-center","gap-4","py-5",3,"click"],["width","56px","height","56px","alt","Chat Icon",1,"min-w-14","size-14","rounded-full",3,"src"],[1,"flex","flex-1","flex-col","justify-center","gap-1","text-primary-foreground"],[1,"text-primary-foreground","text-xl"],[1,"flex","justify-between","items-center","gap-1","text-sm"],[1,"text-muted-foreground","text-ellipsis","line-clamp-1","flex-1","m-0"],[1,"text-muted-foreground","m-0"],[1,"bg-destructive","rounded-lg","divide-y-[.25px]","divide-destructive-foreground","px-5","animate-pulse"],[4,"ngIf"],["class","flex items-center gap-4 py-5 w-full h-[120px]",4,"ngFor","ngForOf"],[1,"flex","items-center","gap-4","py-5","w-full","h-[120px]"],[1,"size-14","rounded-full","bg-muted"],[1,"flex-1","flex","flex-col","gap-2","justify-center"],[1,"h-3.5","w-24","rounded-lg","bg-muted"],[1,"flex","gap-1","items-center"],[1,"flex-1","h-3.5","rounded-lg","bg-muted"],[1,"w-12","h-3.5","rounded-lg","bg-muted"]],template:function(s,a){if(1&s&&(t.DNE(0,M,3,1,"ng-container",0),t.DNE(1,S,2,1,"ng-template",null,1,t.C5r)),2&s){const i=t.sdS(2);t.Y8G("ngIf",!a.isLoading)("ngIfElse",i)}},dependencies:[l.Sq,l.bT,c.nf,b.t]}),o})();const F=["logoutDialogChat"];function k(e,o){if(1&e){const n=t.RV6();t.qex(0),t.j41(1,"div",9)(2,"app-chat-messages",10),t.bIt("onMessageSelected",function(a){t.eBV(n);const i=t.XpG();return t.Njj(i.onMessageSelected(a))}),t.k0s()(),t.bVm()}if(2&e){const n=t.XpG();t.R7$(2),t.Y8G("messages",n.chatsList)}}function G(e,o){1&e&&(t.qex(0),t.j41(1,"div",9),t.nrm(2,"app-chat-messages",11),t.k0s(),t.bVm()),2&e&&(t.R7$(2),t.Y8G("isLoading",!0))}function E(e,o){1&e&&(t.qex(0),t.nrm(1,"app-chat-empty-state"),t.bVm())}const R=[{path:"",component:(()=>{var e;class o{constructor(s,a,i,d,w){this.navCtrl=s,this.router=a,this.apiChat=i,this.socketService=d,this.cdr=w,this.utils=new h.b,this.chatsList=[],this.isLoadingChatList=!1}ngOnInit(){this.socketService.listen("newMessage",s=>{this.updateChat(s)})}ionViewWillEnter(){this.allChats()}goToDetails(s,a){localStorage.setItem("messages",JSON.stringify(a)),this.router.navigateByUrl(s)}goTo(s){this.router.navigateByUrl(s)}goBack(){this.navCtrl.navigateRoot("")}allChats(){this.isLoadingChatList=!0,setTimeout(()=>{this.apiChat.getChat({}).subscribe({next:s=>{this.chatsList=s,this.isLoadingChatList=!1,this.cdr.detectChanges()},error:s=>{this.isLoadingChatList=!1}})},100)}updateChat(s){let a=this.chatsList.findIndex(i=>i.id===s.chats_id);if(-1!==a){this.chatsList[a].lastMsg=s.message,this.chatsList[a].messages||(this.chatsList[a].messages=[]);const i=localStorage.getItem("user_id");s.isSender=null!==i&&""!==i&&parseInt(i)===s.user_id,this.chatsList[a].messages.push(s),this.chatsList[a].datetime_update=(new Date).toISOString(),this.chatsList[a].unreadMsgCount+=1,this.cdr.detectChanges()}else console.log(`\u26a0\ufe0f Chat ${s.chats_id} no encontrado en la lista.`)}onMessageSelected(s){console.log(s),this.goToDetails("/message",s)}stablishUrlPic(s){return this.utils.stablishUrlPic(s)}searchIcon(s){return this.stablishUrlPic(s)}}return(e=o).\u0275fac=function(s){return new(s||e)(t.rXU(C.q9),t.rXU(g.Ix),t.rXU(u.G),t.rXU(x.L),t.rXU(t.gRc))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-chats"]],viewQuery:function(s,a){if(1&s&&t.GBs(F,5,c.Sb),2&s){let i;t.mGM(i=t.lsd())&&(a.logoutDialog=i.first)}},decls:13,vars:5,consts:[["mode","ios",1,"ion-no-border",3,"translucent"],["color","false",1,"bg-background"],[1,"flex","justify-between","items-center","px-2","py-5",2,"position","relative"],[1,"material-icons","text-primary-foreground",3,"click"],[1,"text-lg","font-bold","flex-1","text-center","text-ellipsis","line-clamp-1","text-primary-foreground"],[1,"p-0","m-0","bg-transparent"],["menu","app-menu","color","whiteColor",1,"menu-button-custom",2,"font-size","30px"],[1,"bg-background",3,"fullscreen"],[4,"ngIf"],[1,"px-1.5"],[3,"messages","onMessageSelected"],[3,"isLoading"]],template:function(s,a){1&s&&(t.j41(0,"ion-header",0)(1,"ion-toolbar",1)(2,"div",2)(3,"span",3),t.bIt("click",function(){return a.goBack()}),t.EFF(4," arrow_back_ios "),t.k0s(),t.j41(5,"ion-text",4),t.EFF(6," Mensajes "),t.k0s(),t.j41(7,"ion-chip",5),t.nrm(8,"ion-menu-button",6),t.k0s()()()(),t.j41(9,"ion-content",7),t.DNE(10,k,3,1,"ng-container",8),t.DNE(11,G,3,1,"ng-container",8),t.DNE(12,E,2,0,"ng-container",8),t.k0s()),2&s&&(t.Y8G("translucent",!1),t.R7$(9),t.Y8G("fullscreen",!0),t.R7$(1),t.Y8G("ngIf",a.chatsList.length&&!a.isLoadingChatList),t.R7$(1),t.Y8G("ngIf",a.isLoadingChatList),t.R7$(1),t.Y8G("ngIf",!a.chatsList.length&&!a.isLoadingChatList))},dependencies:[l.bT,c.ZB,c.W9,c.eU,c.MC,c.IO,c.ai,v,j],styles:[".searchFieldWrapper[_ngcontent-%COMP%]{background-color:var(--extraLightGrayColor);padding:15px 12px;border-radius:10px;margin-top:25px}.messageCountWrapper[_ngcontent-%COMP%]{width:24px;height:24px;border-radius:12px;background-color:var(--primaryColor);margin-top:5px}.custom-background[_ngcontent-%COMP%]{--background: #2758BF}.rounded-top-corners[_ngcontent-%COMP%]{border-top-left-radius:20px;border-top-right-radius:20px;overflow:hidden;background-color:#2758bf}.dialogButton[_ngcontent-%COMP%]{flex:1;background-color:#2758bf;padding:12px}.menu-button-custom[_ngcontent-%COMP%]{background:none;border:none;box-shadow:none;margin:0}"]}),o})()}];let T=(()=>{var e;class o{}return(e=o).\u0275fac=function(s){return new(s||e)},e.\u0275mod=t.$C({type:e}),e.\u0275inj=t.G2t({imports:[g.iI.forChild(R),g.iI]}),o})();var $=r(3887);let U=(()=>{var e;class o{}return(e=o).\u0275fac=function(s){return new(s||e)},e.\u0275mod=t.$C({type:e}),e.\u0275inj=t.G2t({providers:[u.G],imports:[l.MD,m.YN,c.bv,T,f.q1,$.G]}),o})()}}]);